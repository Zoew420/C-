# 陈婉仪个人报告
***
## 分工任务
我们的项目包括了3次迭代：

在第一轮迭代中，我负责了View层的开发以显示粒子；

在第二轮迭代中，我负责了View层的操作面板的实现以及其对应功能的实现；

在第三轮迭代中，我主要负责了Model层和ViewModel层中温度模拟逻辑的组织和实现，以及View层的部分更新完善。

## 设计思路
### 图形库的选择
在图形库选择时，我们小组定下了GitHub上一个开源的年轻的图形库[ImGui](https://github.com/ocornut/imgui)。
然后开始学习这个陌生的图形库。

### 窗口设计
基于这个图形库，我设计了控制面板窗口与画笔绘图区域，并在三轮迭代中加入画笔绘图区域的温度和压强的纹理绘图显示区域来表示钟嘉农同学实现的温度压强数据可视化。

效果图如下：
![操作面板](file:E:/360MoveData/Users/Chen/Desktop/C-/img/pad.png)

![窗口效果](file:E:/360MoveData/Users/Chen/Desktop/C-/img/window.png)

在Simflow的程序窗口中，Control Pad的左侧是画笔绘图区域，拖拽鼠标即可绘制粒子。
在Control Pad上方的矩形选框中，勾选表示其对应的标签或绘图区域显示在程序窗口中。在Draw Item标签页中可以选择画笔的粒子属性和笔刷大小，在Brush Function标签页中可以选择笔刷功能是画笔或是升降温，在Exit标签页中可以按按钮退出程序。

在Pressure Graph图中，高压是红色，低压是蓝色。

在Heat Graph图中，灰色是常温，红色是高温，蓝色是低温。


### View层和ViewModel层的交互
MVVM模式即View和ViewModel之间的数据通过双向绑定进行联系，View和Model层之间不产生联系，因此View层和ViewModel层之间有许多的消息传递。

View层中，程序窗口画面的每一帧，View层都通知ViewModel层进行逻辑更新：
>EventSource<> event_update;
	
鼠标在画笔绘图区域点击左键或按下左键进行拖拽时，要更新画面粒子的位置、属性、温度等信息并将其传递给ViewModel层：
>EventSource<ParticleBrush> event_new_particles;
>
>EventSource<HeatBrush> event_change_heat;

而当ViewModel得到由Model计算好的下一帧画面的所有数据时，View层要对ViewModel所传递的画面数据进行绘制:
>shared_ptr<EventHandler<FrameData>>on_frame_ready;

>void Handler(FrameData data);

### 画面矩阵的温度传递
在第三轮迭代中，加入了画面的温度模拟。

我们设常温为25℃，刚画到画布上的粒子也是常温，使用降温和升温笔刷可以对粒子的温度进行改变（注:无法改变空气温度，即不相邻的粒子之间不能进行温度传递）。

在温度传递中，使用了热传导方程，即：
![热传导方程](file:E:/360MoveData/Users/Chen/Desktop/C-/img/热传导.png)，
其中热导率为
![热导率](file:E:/360MoveData/Users/Chen/Desktop/C-/img/热导率.png)，
其中的拉普拉斯算子在二维平面内可以简化为上下左右像素点的均温与该处的温度的差值的均值，
然后使用该公式即可得到每秒温度变化的值。

## 个人心得
在课程过程中，我学会了
- MVVM模式在C++编程中的应用，使得我们的合作分工更加协调
- 学会了使用git进行版本控制。版本控制真的特别重要，在最后对程序界面进行精修时，不同时期对于不同控件的调用通过版本控制都可以在GitHub上找到历史，极大方便我对界面进行调整
- 学会了持续集成环境如travis CI的使用方法，使得我对电脑编程环境更加熟悉
- 学会了一个新的图形库ImGUI的使用
- 对智能指针有了更深刻的了解

此外，在线下面对面一起写工程进行讨论比线上效率更高，关于合作中不懂的部分可以得到同组同学或是老师的及时解答，编程效率大大提高。

这门课程虽是针对CPP的，但是思想可以应用到Python，Java等更广泛的语言。有这种版本控制、持续集成、分模块合作的思想在，我们的合作项目的效率都可以得到提高。

## 对课程的改进意见
1.- 对于初次接触持续集成的大家来说，持续集成可能需要花更长的时间去配置一个demo的环境，所以在课后任务安排的时间上建议有所调整

2.- 讲解MVVM模式时，按照学校课程安排，我们的CPP基础对于智能指针几乎没有了解，因此在理解demo的各种绑定时有一定的困难，建议老师可以调查一下班上同学对于智能指针的了解情况来决定是否开展基础普及